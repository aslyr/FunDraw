function isProperNum(a){"Number"==typeof a?(num=[],num[0]=a):a instanceof Array&&(num=a);for(var b=0;b<num.length;b++)if(1/0==Number(num[b])||isNaN(num[b]))return!1;return!0}function toPi(a){if(Math.abs(a)>.01&&(Math.abs(a%Math.PI)<=.01||Math.abs(Math.PI%a)<=.01)){var b=(a/Math.PI).GetRound(2);return 1==b&&(b=""),-1==b&&(b="-"),b+"π"}return a.GetRound(5)}function move(a){document.getElementById("dx").value=ox+a.clientX-x1,document.getElementById("dy").value=oy+a.clientY-y1,Fundraw()}function zoom(a){document.getElementById("jx").value=Number(document.getElementById("jx").value)<=10?Number(document.getElementById("jx").value)*Math.pow(2,a.wheelDelta/Math.abs(a.wheelDelta)):Number(document.getElementById("jx").value)+10*(a.wheelDelta/Math.abs(a.wheelDelta)),document.getElementById("jy").value=Number(document.getElementById("jy").value)<=10?Number(document.getElementById("jy").value)*Math.pow(2,a.wheelDelta/Math.abs(a.wheelDelta)):Number(document.getElementById("jy").value)+10*(a.wheelDelta/Math.abs(a.wheelDelta)),Fundraw()}function Fundraw(a){var b,c,d,e,f,g,i,j,k,l;for("function"==typeof a?(func=[],func[0]=a):a instanceof Array&&(func=a),can.width=w,can.height=h,isProperNum([document.getElementById("jx").value,document.getElementById("jy").value,document.getElementById("dx").value,document.getElementById("dy").value])||(document.getElementById("jx").value=200,document.getElementById("jy").value=200,document.getElementById("dx").value=200,document.getElementById("dy").value=200),(Number(document.getElementById("jx").value)<=0||Number(document.getElementById("jy").value)<=0)&&(document.getElementById("jx").value=200,document.getElementById("jy").value=200),jx=Number(document.getElementById("jx").value),jy=Number(document.getElementById("jy").value),dx=Number(document.getElementById("dx").value),dy=Number(document.getElementById("dy").value),context=can.getContext("2d"),context.font="15px Math",context.beginPath(),context.lineWidth=1,context.fillText(0,dx+7,dy+12),context.moveTo(0,dy),context.lineTo(w,dy),context.moveTo(dx,0),context.lineTo(dx,h),context.stroke(),b=0;b<func.length;b++)for(context.beginPath(),context.lineWidth=1,c=0,context.strokeStyle=color[b%color.length],d=0;w>=d;d+=.5)x=(d-dx)/jx,y=func[b](x),py=dy-y*jy,line?(context.lineTo(d,py),d==w&&context.stroke()):(context.beginPath(),context.lineWidth=.5,context.strokeStyle=y>=c?"#FF5722":"#4CAF50",context.arc(d,py,.25,0,2*Math.PI),context.stroke(),context.closePath()),c=y;if(e=(0-dx)/jx,f=(w-dx)/jx,g=0,i=[],jx>sing)for(d=jx;d>sing;d/=2)g++;if(sing>=jx)for(d=jx;sing>=d;d=2*d)g--;for(d=Math.floor(e),b=0;0!=d&&(i[b]=d),!(d>f);d+=1/Math.pow(2,g),b++);for(d=0;d<i.length;d++)context.beginPath(),context.moveTo(i[d]*jx+dx,Math.max(0,Math.min(dy-3,h-3))),context.lineTo(i[d]*jx+dx,Math.max(3,Math.min(dy,h))),context.textAlign="center",context.strokeStyle="#9E9E9E",context.lineWidth=1,context.stroke(),context.fillText(i[d],i[d]*jx+dx,Math.max(15,Math.min(dy+16,h-7)));if(j=dy/jy,k=(dy-h)/jy,g=0,l=[],jy>sing)for(d=jy;d>sing;d/=2)g++;if(sing>=jy)for(d=jy;sing>=d;d=2*d)g--;for(d=Math.ceil(j),b=0;0!=d&&(l[b]=d),!(k>d);d-=1/Math.pow(2,g),b++);for(d=0;d<l.length;d++)context.beginPath(),context.moveTo(Math.max(0,Math.min(dx-3,w-3)),-l[d]*jy+dy),context.lineTo(Math.max(3,Math.min(dx,w)),-l[d]*jy+dy),dx>w/2?(context.textAlign="right",delt=-8):(context.textAlign="left",delt=5),context.strokeStyle="#9E9E9E",context.lineWidth=1,context.stroke(),context.fillText(l[d],Math.max(5,Math.min(dx+delt,w-10)),-l[d]*jy+dy+5)}function Funchange(a,b){a.parentNode.previousSibling.value=Number(a.parentNode.previousSibling.value)+b,Fundraw()}function Funcline(){line=!line,Fundraw()}var ele=document.createElement("span");ele.innerHTML="<div><button onclick='$(\"#Funpanel\").toggle(\"slow\")'>Control Panel</button><div id='Funpanel' style='display:none'><input type ='text' onchange='Fundraw()' style='display:inline-block' value='200' id='jx'><span style='display:inline-block;overflow:hidden;line-height:4px;width:20px;position: relative;top: 8px;left: -9px;'><input style='height:12px;width:20px;padding:0' type='button' value='+' onclick='Funchange(this,10)'><input style='height:12px;width:20px;padding:0' type='button' value='-' onclick='Funchange(this,-10)'></span><input type='text' onchange='Fundraw()' style='display:inline-block' value='200'  id='jy'><span style='display:inline-block;overflow:hidden;line-height:4px;width:20px;position: relative;top: 8px;left: -9px;'><input style='height:12px;width:20px;padding:0' type='button' value='+' onclick='Funchange(this,10)'><input style='height:12px;width:20px;padding:0' type='button' value='-' onclick='Funchange(this,-10)'></span><br><input type ='text' onchange='Fundraw()' style='display:inline-block' value='300' id='dx'><span style='display:inline-block;overflow:hidden;line-height:4px;width:20px;position: relative;top: 8px;left: -9px;'><input style='height:12px;width:20px;padding:0' type='button' value='+' onclick='Funchange(this,10)'><input style='height:12px;width:20px;padding:0' type='button' value='-' onclick='Funchange(this,-10)'></span><input type='text' onchange='Fundraw()' style='display:inline-block' value='300'  id='dy'><span style='display:inline-block;overflow:hidden;line-height:4px;width:20px;position: relative;top: 8px;left: -9px;'><input style='height:12px;width:20px;padding:0' type='button' value='+' onclick='Funchange(this,20)'><input style='height:12px;width:20px;padding:0' type='button' value='-' onclick='Funchange(this,-20)'></span><br><input type='checkbox' style='display:inline-block' onclick='Funcline()' id='line' checked><label for='line'>连线</label></div><canvas id='can' style='cursor: pointer;border:solid #D2D2D2 1px;margin:20px auto;'></canvas></div>",funcgraph.appendChild(ele),line=!0,w=funcgraph.clientWidth,h=funcgraph.clientHeight-20,color=["#F44336","#9C27B0","#3F51B5","#00BCD4","#4CAF50","#FFC107","#795548","#607D8B"],sing=150,Number.prototype.GetRound=function(a){return Math.round(this*Math.pow(10,a))/Math.pow(10,a)},can.addEventListener("mousedown",function(a){ox=Number(document.getElementById("dx").value),oy=Number(document.getElementById("dy").value),x1=a.clientX,y1=a.clientY,can.addEventListener("mousemove",move)}),can.addEventListener("mouseup",function(){can.removeEventListener("mousemove",move)}),can.addEventListener("mouseout",function(){can.removeEventListener("mousemove",move),can.removeEventListener("mousewheel",zoom)}),can.addEventListener("mouseover",function(){can.addEventListener("mousewheel",zoom)}),can.addEventListener("mousemove",function(a){var c,b=a.clientX-can.getBoundingClientRect().left;for(context.beginPath(),context.textAlign="left",context.fillStyle="white",context.strokeStyle="white",context.fillRect(w-130,0,130,20*func.length+30),context.strokeRect(w-130,0,130,20*func.length+30),context.fillStyle="black",context.strokeStyle="black",context.fillText("x="+toPi((b-dx)/jx),w-120,20),c=0;c<func.length;c++)context.fillStyle=color[c%color.length],context.strokeStyle=color[c%color.length],context.fillText(void 0!==func[c]((b-dx)/jx)?"f(x)="+toPi(func[c]((b-dx)/jx)):"Undefined",w-120,20*c+40)});